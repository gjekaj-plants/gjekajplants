<!DOCTYPE html>
<html lang="sq">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Gjekaj Plants – Katalogu i Bimëve</title>

  <!-- SEO -->
  <meta name="description" content="Gjekaj Plants – Katalog bimësh dekorative, pemë, fidanë. Porosi online në WhatsApp." />
  <meta name="keywords" content="bimë, fidanë, pemë dekorative, Gjekaj Plants, Shkodër" />

  <!-- SUPABASE CDN (DOMOSDOSHMË) -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <style>
    body{
      margin:0;
      font-family:system-ui,Arial;
      background:#f4f6f8;
    }
    header{
      background:#0f172a;
      color:#fff;
      padding:14px;
      text-align:center;
    }
    .wrap{
      max-width:1100px;
      margin:auto;
      padding:16px;
      display:grid;
      grid-template-columns:1fr 320px;
      gap:16px;
    }
    @media(max-width:900px){
      .wrap{grid-template-columns:1fr;}
    }
    .filters{
      background:#fff;
      padding:14px;
      border-radius:12px;
      display:grid;
      gap:10px;
    }
    input,select{
      padding:10px;
      border-radius:8px;
      border:1px solid #ccc;
      width:100%;
    }
    .grid{
      display:grid;
      grid-template-columns:repeat(auto-fill,minmax(240px,1fr));
      gap:16px;
    }
    .card{
      background:#fff;
      border-radius:14px;
      overflow:hidden;
      box-shadow:0 5px 14px rgba(0,0,0,.08);
    }
    .card img{
      width:100%;
      height:180px;
      object-fit:cover;
    }
    .card .p{
      padding:12px;
    }
    .price{
      color:#b91c1c;
      font-weight:700;
      font-size:20px;
    }
    .cart{
      background:#0f172a;
      color:#fff;
      padding:14px;
      border-radius:14px;
      position:sticky;
      top:10px;
      height:fit-content;
    }
    .status{
      margin:10px 0;
      font-weight:600;
    }
  </style>
</head>

<body>

<header>
  <h2>Gjekaj Plants – Katalogu i Bimëve</h2>
  <div>Dajç, Shkodër • Tel: +355697232425</div>
</header>

<div class="wrap">

  <!-- MAJTA -->
  <div>
    <div class="filters">
      <input id="search" placeholder="Kërko (emër / kategori / kod)">
      <select id="category">
        <option value="">Të gjitha kategoritë</option>
      </select>
    </div>

    <div class="status" id="status">Duke u lidhur…</div>
    <div class="grid" id="products"></div>
  </div>

  <!-- DJATHTA -->
  <div class="cart">
    <h3>Shporta</h3>
    <div>Shporta është bosh.</div>
    <div style="margin-top:10px;font-size:18px">
      0 Lekë • 0.00 €
    </div>
  </div>

</div>

<script>
/* =========================
   KONFIGURIMI
========================= */
const SUPABASE_URL = "https://YOUR_PROJECT_ID.supabase.co";
const SUPABASE_ANON_KEY = "sb_publishable_Ll_tV3Hs9MmMO54DaDWGiQ_KRpED8xd";
const TABLE_NAME = "products";

/* =========================
   INIT
========================= */
const statusEl = document.getElementById("status");
const gridEl = document.getElementById("products");
const catEl = document.getElementById("category");
const searchEl = document.getElementById("search");

const supabase = window.supabase.createClient(
  SUPABASE_URL,
  SUPABASE_ANON_KEY
);

let ALL = [];

/* =========================
   LOAD DATA
========================= */
async function load(){
  try{
    statusEl.textContent = "Duke ngarkuar artikujt…";
    const { data, error } = await supabase
      .from(TABLE_NAME)
      .select("*");

    if(error) throw error;

    ALL = data || [];
    buildCategories();
    render();
    statusEl.textContent = ALL.length + " artikuj";
  }catch(e){
    console.error(e);
    statusEl.textContent = "Gabim lidhjeje me Supabase";
  }
}

/* =========================
   UI
========================= */
function buildCategories(){
  const set = new Set();
  ALL.forEach(r=> r.category && set.add(r.category));
  catEl.innerHTML = '<option value="">Të gjitha kategoritë</option>';
  [...set].forEach(c=>{
    const o = document.createElement("option");
    o.value = c;
    o.textContent = c;
    catEl.appendChild(o);
  });
}

function render(){
  const q = searchEl.value.toLowerCase();
  const c = catEl.value;
  gridEl.innerHTML = "";

  ALL.filter(r=>{
    if(c && r.category!==c) return false;
    if(q && !(
      (r.name||"").toLowerCase().includes(q) ||
      (r.code||"").toLowerCase().includes(q)
    )) return false;
    return true;
  }).forEach(r=>{
    const d = document.createElement("div");
    d.className = "card";
    d.innerHTML = `
      <img src="${r.photo_url||''}">
      <div class="p">
        <h3>${r.name}</h3>
        <div>Kodi: ${r.code}</div>
        <div class="price">${r.price_lek} Lekë</div>
      </div>
    `;
    gridEl.appendChild(d);
  });
}

/* =========================
   EVENTS
========================= */
searchEl.oninput = render;
catEl.onchange = render;

/* =========================
   START
========================= */
load();
</script>

</body>
</html>
